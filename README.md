# web-app-check-table-table2
📊 不担保人事用合同记录表自动审核系统（多Sheet版）
🧭 项目简介

本项目是一个基于 Streamlit 开发的自动化数据审核工具，用于对「不担保人事用合同记录表」进行智能化、多维度的字段比对。
系统支持多文件、多Sheet自动识别，自动标注错误并输出审核结果文件，极大地减少人工检查工作量。

⚙️ 功能特点

✅ 多文件上传（不担保表、放款明细、字段、二次明细、重卡数据）
✅ 自动识别匹配列名
✅ 支持多Sheet检查（如「二次」「部分担保」「随州」）
✅ 每个Sheet带进度条与耗时统计
✅ 错误字段自动标红，合同号标黄
✅ 支持下载带标注的审核结果Excel文件
✅ 审核完成后显示总错误数与总耗时

📂 输入文件要求

程序运行时需要上传 5 个 Excel 文件，文件名中应包含下列关键字（不区分大小写）：

文件类型	文件名应包含	说明
不担保表	不担保	主审核表，程序主要检查此表内容
放款明细	放款明细	用于比对放款相关字段
字段表	字段	用于核对字段定义与比例等
二次明细	二次明细	用于校验“二次”相关信息
重卡数据	重卡数据	用于比对“重卡”业务信息

⚠️ 若文件名中不包含对应关键字，程序将无法识别并报错。

🧩 数据比对逻辑

系统通过预设字段映射关系对多个表间的数据进行一致性检查。

放款明细字段比对
不担保表字段	放款明细字段
授信方	授信
租赁本金	本金
租赁期限月	租赁期限月
客户经理	客户经理
起租收益率	收益率
主车台数	主车台数
挂车台数	挂车台数
字段表字段比对
不担保表字段	字段表字段
保证金比例	保证金比例_2
项目提报人	提报
起租时间	起租日_商
租赁期限月	总期数_商_资产
二次明细与重卡数据
不担保表字段	参照表字段
二次时间	出本流程时间
结清日期	核销

若检测到字段内容不一致：

对应单元格将标 红色；

对应合同号单元格标 黄色；

所有错误数量会被统计汇总。

🧮 审核进度与耗时统计

系统在每个 Sheet 审核时：

显示动态进度条；

输出当前检查进度（如“正在检查二次... 120/500行”）；

计算每个Sheet与总的耗时。

示例输出：

✅ 二次 审核完成，共发现 15 处错误，用时 8.42 秒。
✅ 部分担保 审核完成，共发现 6 处错误，用时 5.71 秒。
🎯 全部审核完成，共发现 21 处错误，总耗时 14.13 秒。

💾 输出结果

每个审核完成的Sheet会生成带标注的Excel文件，文件命名格式如下：

不担保_二次_审核标注版.xlsx
不担保_部分担保_审核标注版.xlsx
不担保_随州_审核标注版.xlsx


用户可直接点击 Streamlit 页面中的下载按钮：

📥 下载 不担保_二次_审核标注版.xlsx

🚀 运行方式
1️⃣ 安装依赖
pip install streamlit pandas openpyxl

2️⃣ 运行系统
streamlit run main.py

3️⃣ 上传文件并开始审核

在浏览器界面中：

上传所有 5 份 Excel 文件；

点击开始审核；

等待进度条完成后，下载带标注结果文件。

📊 运行界面预览
📊 不担保人事用合同记录表自动审核系统（多Sheet版）

✅ 文件上传完成
🚀 开始多sheet检查，请耐心等待...

[██████████░░░░░░░░░░░░░░] 60%
正在检查「二次」... 300/500 行

✅ 二次 审核完成，共发现 15 处错误，用时 8.42 秒。
📥 下载 不担保_二次_审核标注版.xlsx

⚡ 优化建议

Excel 文件不宜过大（推荐 < 10MB）；

保持列名清晰、无多余空格；

尽量不要在表头前插入空行；

运行时建议关闭其他占用CPU的程序以提升速度。

🧠 后续可扩展方向

自定义字段映射规则；

审核报告汇总（统计每类字段错误数）；

自动识别所有Sheet；

增加“错误比例”图表；

一键导出综合审核报告（Excel或PDF）。

作者提示：
本工具专为内部财务与人事核对流程设计，旨在提升数据准确性与效率，
建议在正式审核前进行一次测试运行以确保字段匹配正常。
