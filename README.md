# web-app-check-table-table2
📊 模拟Project：人事用合同记录表自动审核系统（多Sheet版）
🧩 简介

本项目是一个基于 Streamlit 的自动化 Excel 审核系统，用于模拟人事/财务合同数据的自动比对、异常标注和结果汇总。
系统可自动对多个 Excel 表格进行交叉核对，对不一致的内容进行红色标记，并在合同时标黄以便人工复核。

⚙️ 功能说明
功能模块	说明
📁 文件上传	一次上传 5 个 Excel 文件（记录表、放款明细、字段、二次明细、重卡数据）
🧾 多Sheet支持	自动识别“二次”、“部分担保”、“随州”等关键字的 sheet 进行循环审核
🔍 精确与模糊匹配	某些字段（如“城市经理”）要求精确匹配；其余字段允许模糊匹配
🧮 数值容差	“保证金比例”允许 ±0.005 的数值浮动
⏳ 进度与耗时	显示实时进度条与已用时间
🚫 空值跳过逻辑	若“字段”表中“城市经理”列为空，则跳过该合同的经理比对，并统计跳过数量
📊 汇总统计	输出错误总数、跳过数量、总耗时
💾 结果导出	每个 sheet 会输出标红后的审核版 Excel 文件，可直接下载
📂 输入文件说明
文件名关键词	内容说明	用途
记录表	含多sheet，是审核主表	主要被检查对象
放款明细	包含“租赁本金”、“授信方”等	用于基础数据比对
字段	包含“保证金比例”、“城市经理”等	用于字段精确匹配（含容差与跳过逻辑）
二次明细	包含“二次时间”字段	参与附加字段比对
重卡数据	包含“结清日期”或“核销”等字段	用于末端验证
🔧 字段比对映射表
来源文件	主表字段（记录表）	对应字段
放款明细	授信方 → 授信	
放款明细	租赁本金 → 本金	
放款明细	起租收益率 → 收益率	
字段	保证金比例 → 保证金比例_2（±0.005容差）	
字段	城市经理 → 城市经理（精确匹配 + 空值跳过）	
二次明细	二次时间 → 出本流程时间	
重卡数据	结清日期 → 核销	
🚀 使用步骤

打开命令行（CMD 或终端），安装依赖：

pip install streamlit pandas openpyxl


运行程序：

streamlit run audit_app.py


（假设脚本保存为 audit_app.py）

上传以下 5 个文件：

记录表.xlsx

放款明细.xlsx

字段.xlsx

二次明细.xlsx

重卡数据.xlsx

等待系统自动运行并显示进度条。

每个 sheet 检查完成后，可直接点击下载按钮导出结果。

🧠 核心逻辑概览
步骤	说明
①	自动识别上传文件中含指定关键字的文件名
②	根据关键字（如“二次”、“部分担保”、“随州”）逐一读取记录表的sheet
③	按映射关系比对合同号对应字段
④	若字段值不一致 → 红色标记；若整行有错误 → 合同号黄色标记
⑤	若字段表中“城市经理”为空 → 跳过比对并累计跳过次数
⑥	输出每个sheet的审核结果与总耗时统计
🧾 输出结果

生成的文件命名格式：

记录表_<sheet名>_审核标注版.xlsx


每个结果文件中：

红色单元格 → 字段不一致或差异超过容差

黄色合同号 → 此合同存在至少一项不一致

底部控制台 → 显示每个sheet耗时与跳过数量统计

最终汇总：

🎯 全部审核完成，共发现 XX 处错误，总耗时 XX 秒。
📍 跳过字段表中空城市经理的合同数量总数：YY

🧩 备注

日期字段采用年月日精确比对，忽略格式差异；

数值字段自动去掉逗号与百分号；

若sheet中未找到“合同”相关列，会直接跳过；

设计目标为模拟真实人事/财务Excel核对流程，可拓展接入数据库或API。
